<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Legrand Certificate Lookup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <style>
    :root { --bg:#fff; --fg:#111; --muted:#666; --border:#ddd; --accent:#0d6efd; --danger:#b00020; }
    @media (prefers-color-scheme: dark) { :root { --bg:#0b0c0f; --fg:#e7e7e7; --muted:#a0a0a0; --border:#2a2c33; --accent:#4da3ff; --danger:#ff6b7a; } }
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--fg)}
    .wrap{max-width:1000px;margin:0 auto;padding:20px}
    h1{margin:0 0 10px}
    .card{border:1px solid var(--border);border-radius:12px;padding:16px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    input{padding:10px 12px;font-size:16px;border:1px solid var(--border);border-radius:10px;width:260px;background:var(--bg);color:var(--fg)}
    button{padding:10px 14px;font-size:16px;border:1px solid var(--accent);background:var(--accent);color:#fff;border-radius:10px;cursor:pointer}
    .ghost{background:transparent;color:var(--accent)}
    .pill{font-size:12px;padding:4px 8px;border:1px solid var(--border);border-radius:999px;color:var(--muted)}
    .hint{color:var(--muted);font-size:12px;margin-top:6px}
    .err{color:var(--danger);margin:8px 0;font-weight:600}
    .links{display:flex;gap:10px;align-items:center;margin:8px 0 12px;flex-wrap:wrap}
    .links a{color:var(--accent);text-decoration:none}
    .links a:hover{text-decoration:underline}
    .embed{width:100%;height:72vh;border:1px solid var(--border);border-radius:12px;background:#0001}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px;margin-top:10px}
    .thumb{border:1px solid var(--border);border-radius:10px;padding:8px;cursor:pointer;background:transparent}
    .thumb.active{outline:2px solid var(--accent)}
    .thumb .name{font-size:12px;color:var(--muted);margin-top:6px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .thumb img{width:100%;height:140px;object-fit:contain;background:#fafafa;border-radius:6px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Legrand Certificate Lookup</h1>
    <div class="card">
      <form id="f" class="row">
        <label for="lot" class="mono">LOT #</label>
        <input id="lot" placeholder="7-digit LOT (e.g., 1234567)" required autocomplete="off" />
        <button type="submit">Find</button>
        <button type="button" id="clear" class="ghost">Clear</button>
        <span id="status" class="pill" aria-live="polite"></span>
      </form>
      <div class="hint">Multiple matches show below â€” click to preview. Supports prefixes (0/_ for &lt;1,000,000) and suffixes (-1, c, (c)).</div>
      <div id="result"></div>
    </div>
  </div>

  <script>
    // Inject the SCRIPT_URL for app.js to read
    window.LEGRAND_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxZ7PpogPnESVCzUIjcfwDztLo9KXi0u-I9aKFqF2LyKpPfsPBJaGxprrEn9Z4uD08-/exec";
  </script>
  <script src="app.js"></script>
</body>
</html>
